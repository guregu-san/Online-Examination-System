Pseudocode
/ / Matina
// USE CASE 3 (U3): EXAM CREATION
// Actors: Instructor, IT Support
// Note: Used ChatGPT for the breakdown, restructuring,
// and refinement of pseudocode and interface design.



// DATABASE DESIGN
TABLE instructors (
    instructor_id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100),
    email VARCHAR(100),
    password_hash VARCHAR(255)
)

TABLE courses (
    course_id INT PRIMARY KEY AUTO_INCREMENT,
    course_code VARCHAR(10),
    course_name VARCHAR(100),
    instructor_id INT,
    FOREIGN KEY (instructor_id) REFERENCES instructors(instructor_id)
)

TABLE exams (
    exam_id INT PRIMARY KEY AUTO_INCREMENT,
    course_id INT,
    instructor_id INT,
    title VARCHAR(100),
    time_limit INT,
    security_settings TEXT,
    created_at DATETIME,
    updated_at DATETIME,
    FOREIGN KEY (course_id) REFERENCES courses(course_id),
    FOREIGN KEY (instructor_id) REFERENCES instructors(instructor_id)
)

TABLE questions (
    question_id INT PRIMARY KEY AUTO_INCREMENT,
    exam_id INT,
    question_text TEXT,
    question_type ENUM('MCQ_SINGLE', 'MCQ_MULTIPLE', 'TRUE_FALSE', 'SHORT_ANSWER', 'NUMERICAL', 'ESSAY'),
    order_index INT,
    FOREIGN KEY (exam_id) REFERENCES exams(exam_id)
)

TABLE answers (
    answer_id INT PRIMARY KEY AUTO_INCREMENT,
    question_id INT,
    answer_text TEXT,
    is_correct BOOLEAN,
    FOREIGN KEY (question_id) REFERENCES questions(question_id)
)

Backend
U3-F1: Load Exam Creation Page
function loadExamCreationPage(email) {
    Set instructor = (SELECT * FROM instructors WHERE email = email)


    if (instructor == NULL)
    do
        Return "Access Denied"
    end else do //TODO
        Return ExamCreationTemplate
    end
}

U3-F2: Create New Exam
procedure createExam(course_code, instructor_email) {
    Set instructor_id = (SELECT instructor_id FROM instructors WHERE email = instructor_email)
    Set course_id = (SELECT course_id FROM courses WHERE course_code = course_code)


    INSERT INTO exams(course_id, instructor_id, title, created_at)
    VALUES (course_id, instructor_id, "Untitled Exam", CURRENT_TIMESTAMP)
    RETURN LAST_INSERT_ID() AS exam_id


    Output "Exam created successfully"
}

U3-F3: Add Question (with validation)
function addQuestion(exam_id, question_text, question_type, answers[]) {
    INSERT INTO questions(exam_id, question_text, question_type, order_index)
    VALUES (exam_id, question_text, question_type, getNextOrderIndex(exam_id))
    question_id = LAST_INSERT_ID()


    // Save all answer options for applicable question types
    if (question_type in ['MCQ_SINGLE', 'MCQ_MULTIPLE'])
    do
        for (answer in answers)
        do
            INSERT INTO answers(question_id, answer_text, is_correct)
            VALUES (question_id, answer.text, answer.is_correct)
        end
    end


    Output "Question added to exam with ID: " + question_id
    Return "Question added successfully"
}

U3-F4: Edit Question
function editQuestion(question_id, new_text, new_type, new_answers[]) {
    UPDATE questions
    SET question_text = new_text,
        question_type = new_type
    WHERE question_id = question_id


    DELETE FROM answers WHERE question_id = question_id


    if (new_type in ['MCQ_SINGLE', 'MCQ_MULTIPLE'])
    do
        for (answer in new_answers)
        do
            INSERT INTO answers(question_id, answer_text, is_correct)
            VALUES (question_id, answer.text, answer.is_correct)
        end
    end


    Output "Question edited successfully"
    Return "Question updated"
}

U3-F5: Delete Question
function deleteQuestion(question_id) {
    DELETE FROM answers WHERE question_id = question_id
    DELETE FROM questions WHERE question_id = question_id


    Output "Question deleted successfully"
    Return "Question deleted"
}

U3-F6: Reorder Questions
function reorderQuestions(exam_id, new_order_list[]) {
    for ((question_id, order_index) in new_order_list)
    do
        UPDATE questions SET order_index = order_index
        WHERE question_id = question_id
    end


    Output "Questions reordered successfully"
    Return "Question order updated"
}

U3-F7: Set Exam Options
function setExamOptions(exam_id, time_limit, security_settings) {
    UPDATE exams
    SET time_limit = time_limit,
        security_settings = security_settings,
        updated_at = CURRENT_TIMESTAMP
    WHERE exam_id = exam_id


    Output "Exam settings updated"
    Return "Settings saved"
}

U3-F8: Save Exam
function saveExam(exam_id, course_id, instructor_id, title, time_limit, security_settings, questions[], answers[]) {
    UPDATE exams SET updated_at = CURRENT_TIMESTAMP WHERE exam_id = exam_id
   
    for (question in questions)
    do
        if (SELECT * FROM questions WHERE question_id = question.question_id)
        do
            editQuestion(exam_id, question.question_text, question.question_type, answers)
        end else
        do
            addQuestion(exam_id, question.question_text, question.question_type, answers)
        end
    end
   
    for (answer in answers)
    do
        if (SELECT * FROM questions WHERE question_id = question.question_id)
        do
            editQuestion(exam_id, question.question_text, question.question_type, answers)
        end else
        do
            addQuestion(exam_id, question.question_text, question.question_type, answers)
        end
    end
   
    Output "Exam saved successfully"
    Return "Exam Saved"
}


U3-F9: Retrieve Instructor Exams
function getInstructorExams(instructor_id) {
    exams = SELECT * FROM exams WHERE instructor_id = instructor_id
   
    Output "Instructor exams retrieved successfully"
    Return exams
}

U3-F10: IT Support Functions
procedure restoreDeletedExam(exam_id) {
    RETRIEVE backup from logs
    REINSERT exam and all related data


    Output "Deleted exam restored"
}


procedure verifyExamIntegrity(exam_id) {
    CHECK that each question has valid answers and type
    REPAIR inconsistencies if found
   
    Output fixes
}




Frontend
//USER INTERFACE (UI)
// U3-UI1: Initial Page
ON PAGE LOAD:
    DISPLAY input fields: [Course Code], [Instructor Name]
    BUTTONS: [Create Exam]


// U3-UI2: Exam Editing Interface
ON CLICK "Create Exam":
    CALL backend.createExam()
    DISPLAY exam editing interface:
        - Add Question
        - Set Time Limit
        - Configure Security
        - Preview Exam
        - Save Exam


// U3-UI3: Add Question Modal
ON CLICK "Add Question":
    DISPLAY dropdown [Question Type]
    DISPLAY textarea [Question Text]
    IF MCQ or TRUE_FALSE:
        SHOW answer fields with “+ Add Option” and “Correct” checkboxes
    VALIDATE input before saving
    CALL backend.addQuestion()


// U3-UI4: Edit and Delete Question Interface
SHOW list of questions with edit/delete icons
ON CLICK "Edit": open editable modal
ON CLICK "Delete": confirm, then CALL backend.deleteQuestion()


// U3-UI5: Reorder Questions
ALLOW drag-and-drop; update order in backend.reorderQuestions()


// U3-UI6: Autosave Indicator
TIMER every 2 minutes:
    CALL backend.autosaveExam(exam_id)
    SHOW small message “Draft saved”


// U3-UI7: Preview Exam
ON CLICK "Preview Exam":
    CALL backend.previewExam(exam_id)
    DISPLAY read-only version of the exam


// U3-UI8: Save Exam
ON CLICK "Save Exam":
    CALL backend.saveExam(exam_id)
    SHOW “Exam saved successfully” and redirect


// U3-UI9: IT Support Tools
AVAILABLE only to admins:
    - Restore deleted exams
    - Verify and repair exam data integrity
