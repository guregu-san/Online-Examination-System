{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}


{%block title%}Register!{%endblock%}

{%block main_content%}
<div class="card">
    <h1>Register Page</h1>
    <form method="POST" action="">
        {{ form.hidden_tag() }}

        <div class="form-row">
            {{ form.role.label }}
            <div class="radio-inline">
                {%- for subfield in form.role -%}
                <label class="radio-item">{{ subfield }} {{ subfield.label.text }}</label>
                {%- endfor -%}
            </div>
        </div>

        

        <div>
            {{ form.email.label }}<br>
            {{ form.email }}
        </div>

        {% if form.email.errors %}
            <div class="text-danger">
                {% for error in form.email.errors %}
                    <small>{{ error }}</small><br>
                {% endfor %}
            </div>
        {% endif %}

        <div>
            {{ form.password.label }}<br>
            {{ form.password }}
        </div>

        <div>
                {{ form.name.label }}<br>
                {{ form.name }}
        </div>
        <div id="student-fields">
            <div>
                {{ form.roll_number.label }}<br>
                {{ form.roll_number }}
            </div>
            <br>
            <div>
                {{ form.contact_number.label }}<br>
                {{ form.contact_number }}
            </div>
            <br>
        </div>
        <div>
            {{ form.submit }}
        </div>
    </form>
    <div>
        <a href="{{url_for('authBp.login')}}">Already have an account? Log In</a><br>
    </div>
</div>


<script>
    // show/hide student-only fields based on selected role
    function updateStudentFields() {
        const studentFields = document.getElementById('student-fields');
        const roleInputs = document.getElementsByName('role');
        let role = 'Student';
        for (const r of roleInputs) {
            if (r.checked) { role = r.value; break; }
        }
        if (role === 'Student') {
            studentFields.style.display = 'block';
        } else {
            studentFields.style.display = 'none';
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        const roleInputs = document.getElementsByName('role');
        for (const r of roleInputs) {
            r.addEventListener('change', updateStudentFields);
        }
        updateStudentFields();
    });
</script>
{%endblock%}